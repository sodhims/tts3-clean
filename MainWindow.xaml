<Window x:Class="TTS3.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="TTS3 - Text to Speech Converter" Height="800" Width="1200">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="200"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Menu Bar -->
        <!-- Menu Bar - Row 0 -->
        <Menu Grid.Row="0" Name="MainMenu">
            <MenuItem Header="File">
                <MenuItem Header="Open Text File..." Click="OpenFile_Click">
                    <MenuItem.Icon>
                        <TextBlock Text="📁"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="Save Text..." Click="SaveText_Click">
                    <MenuItem.Icon>
                        <TextBlock Text="💾"/>
                    </MenuItem.Icon>
                </MenuItem>
                <Separator/>
                <MenuItem Header="Exit" Click="Exit_Click">
                    <MenuItem.Icon>
                        <TextBlock Text="❌"/>
                    </MenuItem.Icon>
                </MenuItem>
            </MenuItem>
            <MenuItem Header="Edit">
                <MenuItem Header="Find..." Click="Find_Click" InputGestureText="Ctrl+F">
                    <MenuItem.Icon>
                        <TextBlock Text="🔍"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="Find and Replace..." Click="FindReplace_Click" InputGestureText="Ctrl+H">
                    <MenuItem.Icon>
                        <TextBlock Text="🔍"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="Random Replace..." Click="RandomReplace_Click" InputGestureText="Ctrl+Shift+R">
                    <MenuItem.Icon>
                        <TextBlock Text="🎲"/>
                    </MenuItem.Icon>
                </MenuItem>
            </MenuItem>
            <MenuItem Header="Tools">
                <MenuItem Header="Audio File Browser..." Click="AudioBrowser_Click">
                    <MenuItem.Icon>
                        <TextBlock Text="🎵"/>
                    </MenuItem.Icon>
                </MenuItem>
                <Separator/>
                <MenuItem Header="Strip/Ignore Characters..." Click="StripCharacters_Click">
                    <MenuItem.Icon>
                        <TextBlock Text="🧹"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="Clean Text" Click="CleanText_Click">
                    <MenuItem.Icon>
                        <TextBlock Text="✨"/>
                    </MenuItem.Icon>
                </MenuItem>
            </MenuItem>
            <MenuItem Header="Help">
                <MenuItem Header="Quick Start Guide" Click="QuickStart_Click">
                    <MenuItem.Icon>
                        <TextBlock Text="📖"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="Tag Reference" Click="TagReference_Click">
                    <MenuItem.Icon>
                        <TextBlock Text="📋"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="SSML Reference" Click="SSMLReference_Click">
                    <MenuItem.Icon>
                        <TextBlock Text="🗣️"/>
                    </MenuItem.Icon>
                </MenuItem>
                <Separator/>
                <MenuItem Header="Keyboard Shortcuts" Click="KeyboardShortcuts_Click">
                    <MenuItem.Icon>
                        <TextBlock Text="⌨️"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="Color Legend" Click="ShowColorLegend_Click">
                    <MenuItem.Icon>
                        <TextBlock Text="🎨"/>
                    </MenuItem.Icon>
                </MenuItem>
                <Separator/>
                <MenuItem Header="About" Click="About_Click">
                    <MenuItem.Icon>
                        <TextBlock Text="ℹ️"/>
                    </MenuItem.Icon>
                </MenuItem>
            </MenuItem>
        </Menu>
        <!-- Toolbar -->
        <ToolBar Grid.Row="1" Height="40">
            <Button Name="btnOpenFile" Click="OpenFile_Click" Padding="10,5">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="📁" Margin="0,0,5,0"/>
                    <TextBlock Text="Open Text File"/>
                </StackPanel>
            </Button>
            <Separator/>
            <ComboBox Name="cmbTTSEngine" Width="150" SelectionChanged="TTSEngine_Changed">
                <ComboBoxItem>Windows SAPI</ComboBoxItem>
                <ComboBoxItem>Google Cloud TTS</ComboBoxItem>
                <ComboBoxItem>AWS Polly</ComboBoxItem>
                <ComboBoxItem>ElevenLabs</ComboBoxItem>
                <ComboBoxItem>Lemonfox AI</ComboBoxItem>
            </ComboBox>
            <Button Name="btnSetCredentials" Click="SetCredentials_Click" Padding="10,5">
                <TextBlock Text="🔑 Set Credentials"/>
            </Button>
            <Separator/>
            <Button Name="btnConvert" Click="Convert_Click" Padding="10,5">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="🔊" Margin="0,0,5,0"/>
                    <TextBlock Text="Convert to Audio"/>
                </StackPanel>
            </Button>
            <Button Name="btnSaveText" Click="SaveText_Click" Padding="10,5">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="💾" Margin="0,0,5,0"/>
                    <TextBlock Text="Save Text"/>
                </StackPanel>
            </Button>
        </ToolBar>

        <!-- Main Editor Area -->
        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="3*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Text Editor -->
            <GroupBox Grid.Column="0" Header="Text Editor" Margin="5">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>


                    <!-- Quick Insert Toolbar -->
                    <ToolBar Grid.Row="0" Height="35">
                        <Button Name="btnInsertSplit" Click="InsertSplit_Click" ToolTip="Insert split tags">
                            <TextBlock Text="&lt;split&gt;"/>
                        </Button>

                        <!-- Service Selection Dropdown -->
                        <Label Content="Service:" VerticalAlignment="Center" Padding="5,0"/>
                        <ComboBox Name="cmbServiceTag" Width="140" ToolTip="Select TTS service">
                            <ComboBoxItem>service=1 (SAPI)</ComboBoxItem>
                            <ComboBoxItem>service=2 (Google)</ComboBoxItem>
                            <ComboBoxItem>service=3 (AWS Polly)</ComboBoxItem>
                            <ComboBoxItem>service=4 (ElevenLabs)</ComboBoxItem>
                            <ComboBoxItem>service=5 (Lemonfox AI)</ComboBoxItem>

                        </ComboBox>
                        <Button Name="btnInsertService" Click="InsertService_Click" ToolTip="Insert service tag" Background="LightCyan">
                            <TextBlock Text="Insert Service"/>
                        </Button>

                        <Separator/>

                        <!-- Voice Selection Dropdown -->
                        <Label Content="Voice:" VerticalAlignment="Center" Padding="5,0"/>
                        <ComboBox Name="cmbVoiceTag" Width="120">
                            <ComboBoxItem>voice=1</ComboBoxItem>
                            <ComboBoxItem>voice=2</ComboBoxItem>
                            <ComboBoxItem>voice=3</ComboBoxItem>
                            <ComboBoxItem>voice=4</ComboBoxItem>
                            <ComboBoxItem>label=1</ComboBoxItem>
                            <ComboBoxItem>vid=myself</ComboBoxItem>
                        </ComboBox>
                        <Button Name="btnInsertVoice" Click="InsertVoice_Click" ToolTip="Insert voice tag">
                            <TextBlock Text="Insert Voice"/>
                        </Button>

                        <Separator/>

                        <Button Name="btnInsertComment" Click="InsertComment_Click" 
                                ToolTip="Insert comment tag (ignored during conversion)" Background="LightYellow">
                            <TextBlock Text="💬 Comment"/>
                        </Button>
                        <TextBox Name="txtCommentText" Width="150" Height="25" 
                                ToolTip="Type comment text here" Text="Enter comment..."/>

                        <Separator/>

                        <!-- SSML Section - Replace the existing SSML section in your toolbar -->
                        <Label Content="SSML:" VerticalAlignment="Center" Padding="5,0"/>
                        <ComboBox Name="cmbSSMLTags" Width="250" Height="25">
                            <ComboBoxItem Content="&lt;emphasis level=&quot;strong&quot;&gt;&lt;/emphasis&gt;"/>
                            <ComboBoxItem Content="&lt;emphasis level=&quot;moderate&quot;&gt;&lt;/emphasis&gt;"/>
                            <ComboBoxItem Content="&lt;break time=&quot;1s&quot;/&gt;"/>
                            <ComboBoxItem Content="&lt;break time=&quot;500ms&quot;/&gt;"/>
                            <ComboBoxItem Content="&lt;prosody rate=&quot;slow&quot;&gt;&lt;/prosody&gt;"/>
                            <ComboBoxItem Content="&lt;prosody rate=&quot;fast&quot;&gt;&lt;/prosody&gt;"/>
                            <ComboBoxItem Content="&lt;prosody pitch=&quot;+5st&quot;&gt;&lt;/prosody&gt;"/>
                            <ComboBoxItem Content="&lt;prosody pitch=&quot;-5st&quot;&gt;&lt;/prosody&gt;"/>
                            <ComboBoxItem Content="&lt;prosody volume=&quot;loud&quot;&gt;&lt;/prosody&gt;"/>
                            <ComboBoxItem Content="&lt;prosody volume=&quot;soft&quot;&gt;&lt;/prosody&gt;"/>
                            <ComboBoxItem Content="&lt;say-as interpret-as=&quot;date&quot; format=&quot;mdy&quot;&gt;&lt;/say-as&gt;"/>
                            <ComboBoxItem Content="&lt;say-as interpret-as=&quot;cardinal&quot;&gt;&lt;/say-as&gt;"/>
                            <ComboBoxItem Content="&lt;say-as interpret-as=&quot;ordinal&quot;&gt;&lt;/say-as&gt;"/>
                            <ComboBoxItem Content="&lt;say-as interpret-as=&quot;spell-out&quot;&gt;&lt;/say-as&gt;"/>
                            <ComboBoxItem Content="&lt;sub alias=&quot;substitute text&quot;&gt;&lt;/sub&gt;"/>
                        </ComboBox>
                        <Button Name="btnInsertSSML" Click="InsertSSML_Click" ToolTip="Insert SSML tag at cursor" Background="Khaki">
                            <TextBlock Text="📝 Insert"/>
                        </Button>
                        <Button Name="btnWrapSSML" Click="WrapSSML_Click" ToolTip="Wrap selected text with SSML" Background="LightBlue">
                            <TextBlock Text="🔄 Wrap"/>
                        </Button>

                        <Separator/>


                        <Button Name="btnHighlightSSML" Click="HighlightSSML_Click" ToolTip="Colorize all tags" Background="Gold">
                            <TextBlock Text="🎨 Colorize"/>
                        </Button>

                        <Button Name="btnTestSelection" Click="TestSelection_Click" 
                                ToolTip="Preview selected text" Background="LightGreen">
                            <TextBlock Text="🔊 Preview"/>
                        </Button>
                        <Button Name="btnStopTestSelection" Click="StopTestSelection_Click" 
                                ToolTip="Stop preview" Background="LightCoral" IsEnabled="False">
                            <TextBlock Text="⏹ Stop"/>
                        </Button>
                        <Button Name="btnValidateSSML" Click="ValidateSSML_Click" 
                                ToolTip="Validate SSML syntax" Background="LightYellow">
                            <TextBlock Text="✓ Validate"/>
                        </Button>
                    </ToolBar>

                    <!-- Text Box -->
                    <RichTextBox Name="rtbTextContent" Grid.Row="1"
                                VerticalScrollBarVisibility="Auto"
                                AcceptsTab="True"
                                FontFamily="Consolas"
                                FontSize="14"/>
                </Grid>
            </GroupBox>

            <GridSplitter Grid.Column="1" Width="5" HorizontalAlignment="Stretch"/>

            <!-- Voice Settings Panel -->
            <GroupBox Grid.Column="2" Header="Voice Settings" Margin="5">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="0" Margin="5">
                        <Label Content="Available Voices:"/>
                        <ComboBox Name="cmbVoices" Height="25" SelectionChanged="Voice_Changed"/>

                        <Label Content="Speech Rate:" Margin="0,10,0,0"/>
                        <Slider Name="sliderRate" Minimum="-10" Maximum="10" Value="0" 
                               TickFrequency="1" IsSnapToTickEnabled="True"/>
                        <TextBlock Text="{Binding ElementName=sliderRate, Path=Value}" 
                                  HorizontalAlignment="Center"/>

                        <Label Content="Volume:" Margin="0,10,0,0"/>
                        <Slider Name="sliderVolume" Minimum="0" Maximum="100" Value="100" 
                               TickFrequency="10" IsSnapToTickEnabled="True"/>
                        <TextBlock Text="{Binding ElementName=sliderVolume, Path=Value}" 
                                  HorizontalAlignment="Center"/>

                        <Label Content="Output Format:" Margin="0,10,0,0"/>
                        <ComboBox Name="cmbOutputFormat" Height="25">
                            <ComboBoxItem>WAV</ComboBoxItem>
                            <ComboBoxItem>MP3</ComboBoxItem>
                        </ComboBox>

                        <Label Content="Options:" Margin="0,10,0,0"/>
                        <CheckBox Name="chkRetainUnmergedFiles" 
                                 Content="Keep sub-files (001a, 001b, etc.)"
                                 Margin="5" IsChecked="False"
                                 ToolTip="Keep individual service files before merging"/>
                    </StackPanel>

                    <!-- Test Voice Buttons -->
                    <StackPanel Grid.Row="2" Orientation="Horizontal" 
                               HorizontalAlignment="Center" Margin="5">
                        <Button Name="btnTestVoice" Click="TestVoice_Click" 
                               Width="80" Height="30" Margin="5">
                            <TextBlock Text="▶ Test"/>
                        </Button>
                        <Button Name="btnStopTest" Click="StopTest_Click" 
                               Width="80" Height="30" Margin="5">
                            <TextBlock Text="⏹ Stop"/>
                        </Button>
                    </StackPanel>
                </Grid>
            </GroupBox>
        </Grid>

        <!-- Output Log and Playback Controls -->
        <Grid Grid.Row="3">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Playback Controls -->
            <GroupBox Grid.Row="0" Header="Playback Controls" Margin="5" Height="80">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- Play Controls -->
                    <StackPanel Grid.Column="0" Orientation="Horizontal" Margin="5">
                        <Button Name="btnPlayPrevious" Click="PlayPrevious_Click" 
                               Width="40" Height="30" Margin="2" IsEnabled="False">
                            <TextBlock Text="⏮"/>
                        </Button>
                        <Button Name="btnPlayPause" Click="PlayPause_Click" 
                               Width="60" Height="30" Margin="2" IsEnabled="False">
                            <TextBlock Text="▶ Play"/>
                        </Button>
                        <Button Name="btnPlayNext" Click="PlayNext_Click" 
                               Width="40" Height="30" Margin="2" IsEnabled="False">
                            <TextBlock Text="⏭"/>
                        </Button>
                        <Button Name="btnStopPlayback" Click="StopPlayback_Click" 
                               Width="50" Height="30" Margin="2" IsEnabled="False">
                            <TextBlock Text="⏹ Stop"/>
                        </Button>
                    </StackPanel>

                    <!-- Progress and File Info -->
                    <StackPanel Grid.Column="1" Margin="10,5">
                        <TextBlock Name="txtCurrentFile" Text="No file loaded" FontWeight="Bold"/>
                        <ProgressBar Name="playbackProgress" Height="10" Margin="0,5"/>
                        <TextBlock Name="txtPlaybackTime" Text="00:00 / 00:00" 
                                  HorizontalAlignment="Center"/>
                    </StackPanel>

                    <!-- File List -->
                    <StackPanel Grid.Column="2" Orientation="Horizontal" Margin="5">
                        <Label Content="File:"/>
                        <ComboBox Name="cmbCreatedFiles" Width="200" 
                                 SelectionChanged="CreatedFile_Changed" IsEnabled="False"/>
                        <Button Name="btnOpenFolder" Click="OpenFolder_Click" 
                               Width="80" Margin="5,0" IsEnabled="False">
                            <TextBlock Text="📁 Folder"/>
                        </Button>
                    </StackPanel>
                </Grid>
            </GroupBox>

            <!-- Output Log -->
            <GroupBox Grid.Row="1" Header="Output Log" Margin="5">
                <TextBox Name="txtLog" TextWrapping="Wrap" 
                        VerticalScrollBarVisibility="Auto" 
                        IsReadOnly="True" FontFamily="Consolas"/>
            </GroupBox>
        </Grid>

        <!-- Status Bar -->
        <StatusBar Grid.Row="4">
            <StatusBarItem>
                <TextBlock Name="txtStatus" Text="Ready"/>
            </StatusBarItem>
            <Separator/>
            <StatusBarItem>
                <ProgressBar Name="progressBar" Width="200" Height="15" Visibility="Collapsed"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>