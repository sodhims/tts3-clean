<Window x:Class="TTS3.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="TTS3 - Text to Speech Converter" Height="800" Width="1400">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="200"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Menu Bar -->
        <Menu Grid.Row="0" Name="MainMenu">
            <MenuItem Header="File">
                <MenuItem Header="Open Text File..." Click="OpenFile_Click">
                    <MenuItem.Icon>
                        <TextBlock Text="📁"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="Save Text..." Click="SaveText_Click">
                    <MenuItem.Icon>
                        <TextBlock Text="💾"/>
                    </MenuItem.Icon>
                </MenuItem>
                <Separator/>
                <MenuItem Header="Exit" Click="Exit_Click">
                    <MenuItem.Icon>
                        <TextBlock Text="❌"/>
                    </MenuItem.Icon>
                </MenuItem>
            </MenuItem>
            <MenuItem Header="Edit">
                <MenuItem Header="Find..." Click="Find_Click" InputGestureText="Ctrl+F">
                    <MenuItem.Icon>
                        <TextBlock Text="🔍"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="Find and Replace..." Click="FindReplace_Click" InputGestureText="Ctrl+H">
                    <MenuItem.Icon>
                        <TextBlock Text="🔍"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="Random Replace..." Click="RandomReplace_Click" InputGestureText="Ctrl+Shift+R">
                    <MenuItem.Icon>
                        <TextBlock Text="🎲"/>
                    </MenuItem.Icon>
                </MenuItem>
            </MenuItem>
            <MenuItem Header="Tools">
                <MenuItem Header="Audio File Browser..." Click="AudioBrowser_Click">
                    <MenuItem.Icon>
                        <TextBlock Text="🎵"/>
                    </MenuItem.Icon>
                </MenuItem>
                <Separator/>
                <MenuItem Header="Audio File Manager..." Click="AudioFileManager_Click">
                    <MenuItem.Icon>
                        <TextBlock Text="🎧"/>
                    </MenuItem.Icon>
                </MenuItem>
                <Separator/>
                <MenuItem Header="Strip/Ignore Characters..." Click="StripCharacters_Click">
                    <MenuItem.Icon>
                        <TextBlock Text="🧹"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="Clean Text" Click="CleanText_Click">
                    <MenuItem.Icon>
                        <TextBlock Text="✨"/>
                    </MenuItem.Icon>
                </MenuItem>
            </MenuItem>
            <MenuItem Header="Help">
                <MenuItem Header="Quick Start Guide" Click="QuickStart_Click">
                    <MenuItem.Icon>
                        <TextBlock Text="📖"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="Tag Reference" Click="TagReference_Click">
                    <MenuItem.Icon>
                        <TextBlock Text="📋"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="SSML Reference" Click="SSMLReference_Click">
                    <MenuItem.Icon>
                        <TextBlock Text="🗣️"/>
                    </MenuItem.Icon>
                </MenuItem>
                <Separator/>
                <MenuItem Header="Keyboard Shortcuts" Click="KeyboardShortcuts_Click">
                    <MenuItem.Icon>
                        <TextBlock Text="⌨️"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="Color Legend" Click="ShowColorLegend_Click">
                    <MenuItem.Icon>
                        <TextBlock Text="🎨"/>
                    </MenuItem.Icon>
                </MenuItem>
                <Separator/>
                <MenuItem Header="About" Click="About_Click">
                    <MenuItem.Icon>
                        <TextBlock Text="ℹ️"/>
                    </MenuItem.Icon>
                </MenuItem>
            </MenuItem>
        </Menu>

        <!-- Toolbar -->
        <ToolBar Grid.Row="1" Height="40">
            <Button Name="btnOpenFile" Click="OpenFile_Click" Padding="10,5">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="📁" Margin="0,0,5,0"/>
                    <TextBlock Text="Open Text File"/>
                </StackPanel>
            </Button>
            <Separator/>
            <ComboBox Name="cmbTTSEngine" Width="150" SelectionChanged="TTSEngine_Changed">
                <ComboBoxItem>Windows SAPI</ComboBoxItem>
                <ComboBoxItem>Google Cloud TTS</ComboBoxItem>
                <ComboBoxItem>AWS Polly</ComboBoxItem>
                <ComboBoxItem>ElevenLabs</ComboBoxItem>
                <ComboBoxItem>Lemonfox AI</ComboBoxItem>
            </ComboBox>
            <Button Name="btnSetCredentials" Click="SetCredentials_Click" Padding="10,5">
                <TextBlock Text="🔑 Set Credentials"/>
            </Button>
            <Separator/>
            <Button Name="btnConvert" Click="Convert_Click" Padding="10,5">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="🔊" Margin="0,0,5,0"/>
                    <TextBlock Text="Convert to Audio"/>
                </StackPanel>
            </Button>
            <Button Name="btnSaveText" Click="SaveText_Click" Padding="10,5">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="💾" Margin="0,0,5,0"/>
                    <TextBlock Text="Save Text"/>
                </StackPanel>
            </Button>
        </ToolBar>

        <!-- Main Editor Area with Tag Toolbox -->
        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="200"/>
                <!-- Tag Toolbox -->
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="3*"/>
                <!-- Text Editor -->
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <!-- Voice Settings -->
            </Grid.ColumnDefinitions>

            <!-- SSML Tag Toolbox Panel (LEFT SIDEBAR) -->
            <Border Grid.Column="0" 
                    BorderBrush="LightGray" 
                    BorderThickness="0,0,1,0"
                    Background="#F5F5F5">
                <DockPanel>
                    <Label DockPanel.Dock="Top" 
                           Content="📋 SSML Tags" 
                           FontWeight="Bold" 
                           FontSize="14"
                           Background="#E0E0E0"
                           Padding="10,8"/>

                    <TextBlock DockPanel.Dock="Bottom"
                               Text="💡 Drag tags to text editor" 
                               FontSize="10"
                               FontStyle="Italic"
                               Foreground="Gray"
                               Margin="5"
                               TextWrapping="Wrap"
                               HorizontalAlignment="Center"/>

                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <StackPanel x:Name="stkTagToolbox" Margin="5">
                            <!-- Control Tags Section -->
                            <TextBlock Text="Control Tags" 
                                      FontWeight="Bold" 
                                      Margin="5,10,5,5"
                                      Foreground="#333"/>

                            <Border x:Name="tagSplit" 
        Background="Cyan" 
        Margin="5,2" 
        Padding="8,6"
        CornerRadius="4"
        Cursor="Hand"
        MouseLeftButtonDown="Tag_Click"
        Tag="split">
                                <TextBlock Text="🔷 &lt;split&gt;" 
              FontFamily="Consolas" 
              Foreground="DarkRed"
              FontWeight="Bold"/>
                            </Border>

                            <Border x:Name="tagVoice" 
        Background="LightGreen" 
        Margin="5,2" 
        Padding="8,6"
        CornerRadius="4"
        Cursor="Hand"
        MouseLeftButtonDown="Tag_Click"
        Tag="voice">
                                <TextBlock Text="🟢 &lt;voice=1&gt;" 
              FontFamily="Consolas" 
              Foreground="DarkGreen"
              FontWeight="Bold"/>
                            </Border>


                            <Border x:Name="tagService" 
        Background="LightBlue" 
        Margin="5,2" 
        Padding="8,6"
        CornerRadius="4"
        Cursor="Hand"
        MouseLeftButtonDown="Tag_Click"
        Tag="service">
                                <TextBlock Text="🔵 &lt;service=1&gt;" 
              FontFamily="Consolas" 
              Foreground="DarkBlue"
              FontWeight="Bold"/>
                            </Border>

                            <Border x:Name="tagLabel" 
        Background="Orange" 
        Margin="5,2" 
        Padding="8,6"
        CornerRadius="4"
        Cursor="Hand"
        MouseLeftButtonDown="Tag_Click"
        Tag="label">
                                <TextBlock Text="🟠 &lt;label=1&gt;" 
              FontFamily="Consolas" 
              Foreground="DarkOrange"
              FontWeight="Bold"/>
                            </Border>

                            <Border x:Name="tagComment" 
        Background="LightGray" 
        Margin="5,2" 
        Padding="8,6"
        CornerRadius="4"
        Cursor="Hand"
        MouseLeftButtonDown="Tag_Click"
        Tag="comment">
                                <TextBlock Text="⚪ &lt;comment=...&gt;" 
              FontFamily="Consolas" 
              Foreground="Gray"
              FontWeight="Bold"/>
                            </Border>

                            <!-- SSML Tags Section -->
                            <TextBlock Text="SSML Tags" 
          FontWeight="Bold" 
          Margin="5,15,5,5"
          Foreground="#333"/>

                            <Border x:Name="tagEmphasis" 
        Background="Yellow" 
        Margin="5,2" 
        Padding="8,6"
        CornerRadius="4"
        Cursor="Hand"
        MouseLeftButtonDown="Tag_Click"
        Tag="emphasis">
                                <TextBlock Text="🟡 &lt;emphasis&gt;" 
              FontFamily="Consolas" 
              Foreground="DarkBlue"
              FontWeight="Bold"/>
                            </Border>

                            <Border x:Name="tagBreak" 
        Background="Yellow" 
        Margin="5,2" 
        Padding="8,6"
        CornerRadius="4"
        Cursor="Hand"
        MouseLeftButtonDown="Tag_Click"
        Tag="break">
                                <TextBlock Text="🟡 &lt;break/&gt;" 
              FontFamily="Consolas" 
              Foreground="DarkBlue"
              FontWeight="Bold"/>
                            </Border>

                            <Border x:Name="tagProsody" 
        Background="Yellow" 
        Margin="5,2" 
        Padding="8,6"
        CornerRadius="4"
        Cursor="Hand"
        MouseLeftButtonDown="Tag_Click"
        Tag="prosody">
                                <TextBlock Text="🟡 &lt;prosody&gt;" 
              FontFamily="Consolas" 
              Foreground="DarkBlue"
              FontWeight="Bold"/>
                            </Border>

                            <Border x:Name="tagSayAs" 
        Background="Yellow" 
        Margin="5,2" 
        Padding="8,6"
        CornerRadius="4"
        Cursor="Hand"
        MouseLeftButtonDown="Tag_Click"
        Tag="say-as">
                                <TextBlock Text="🟡 &lt;say-as&gt;" 
              FontFamily="Consolas" 
              Foreground="DarkBlue"
              FontWeight="Bold"/>
                            </Border>

                            <Border x:Name="tagSub" 
        Background="Yellow" 
        Margin="5,2" 
        Padding="8,6"
        CornerRadius="4"
        Cursor="Hand"
        MouseLeftButtonDown="Tag_Click"
        Tag="sub">
                                <TextBlock Text="🟡 &lt;sub&gt;" 
              FontFamily="Consolas" 
              Foreground="DarkBlue"
              FontWeight="Bold"/>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>
                </DockPanel>
            </Border>

            <GridSplitter Grid.Column="1" Width="5" HorizontalAlignment="Stretch"/>

            <!-- Text Editor -->
            <GroupBox Grid.Column="2" Header="Text Editor" Margin="5">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Quick Insert Toolbar -->
                    <ToolBar Grid.Row="0" Height="35">
                        <Button Name="btnHighlightSSML" Click="HighlightSSML_Click" ToolTip="Colorize all tags" Background="Gold">
                            <TextBlock Text="🎨 Colorize"/>
                        </Button>

                        <Button Name="btnTestSelection" Click="TestSelection_Click" 
                                ToolTip="Preview selected text" Background="LightGreen">
                            <TextBlock Text="🔊 Preview"/>
                        </Button>
                        <Button Name="btnStopTestSelection" Click="StopTestSelection_Click" 
                                ToolTip="Stop preview" Background="LightCoral" IsEnabled="False">
                            <TextBlock Text="⏹ Stop"/>
                        </Button>
                        <Button Name="btnValidateSSML" Click="ValidateSSML_Click" 
                                ToolTip="Validate SSML syntax" Background="LightYellow">
                            <TextBlock Text="✓ Validate"/>
                        </Button>
                    </ToolBar>

                    <!-- Text Box with Drag-Drop Enabled -->
                    <RichTextBox Name="rtbTextContent" Grid.Row="1"
                                VerticalScrollBarVisibility="Auto"
                                AcceptsTab="True"
                                FontFamily="Consolas"
                                FontSize="14"
                                AllowDrop="True"/>
                </Grid>
            </GroupBox>

            <GridSplitter Grid.Column="3" Width="5" HorizontalAlignment="Stretch"/>

            <!-- Voice Settings Panel -->
            <GroupBox Grid.Column="4" Header="Voice Settings" Margin="5">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="0" Margin="5">
                        <Label Content="Available Voices:"/>
                        <ComboBox Name="cmbVoices" Height="25" SelectionChanged="Voice_Changed"/>

                        <Label Content="Speech Rate:" Margin="0,10,0,0"/>
                        <Slider Name="sliderRate" Minimum="-10" Maximum="10" Value="0" 
                               TickFrequency="1" IsSnapToTickEnabled="True"/>
                        <TextBlock Text="{Binding ElementName=sliderRate, Path=Value}" 
                                  HorizontalAlignment="Center"/>

                        <Label Content="Volume:" Margin="0,10,0,0"/>
                        <Slider Name="sliderVolume" Minimum="0" Maximum="100" Value="100" 
                               TickFrequency="10" IsSnapToTickEnabled="True"/>
                        <TextBlock Text="{Binding ElementName=sliderVolume, Path=Value}" 
                                  HorizontalAlignment="Center"/>

                        <Label Content="Output Format:" Margin="0,10,0,0"/>
                        <ComboBox Name="cmbOutputFormat" Height="25">
                            <ComboBoxItem>WAV</ComboBoxItem>
                            <ComboBoxItem>MP3</ComboBoxItem>
                        </ComboBox>

                        <Label Content="Options:" Margin="0,10,0,0"/>
                        <CheckBox Name="chkRetainUnmergedFiles" 
                                 Content="Keep sub-files (001a, 001b, etc.)"
                                 Margin="5" IsChecked="False"
                                 ToolTip="Keep individual service files before merging"/>
                    </StackPanel>

                    <!-- Test Voice Buttons -->
                    <StackPanel Grid.Row="2" Orientation="Horizontal" 
                               HorizontalAlignment="Center" Margin="5">
                        <Button Name="btnTestVoice" Click="TestVoice_Click" 
                               Width="80" Height="30" Margin="5">
                            <TextBlock Text="▶ Test"/>
                        </Button>
                        <Button Name="btnStopTest" Click="StopTest_Click" 
                               Width="80" Height="30" Margin="5">
                            <TextBlock Text="⏹ Stop"/>
                        </Button>
                    </StackPanel>
                </Grid>
            </GroupBox>
        </Grid>

        <!-- Output Log and Playback Controls -->
        <Grid Grid.Row="3">
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>



            <!-- Output Log -->
            <GroupBox Grid.Row="1" Header="Output Log" Margin="5">
                <TextBox Name="txtLog" TextWrapping="Wrap" 
                        VerticalScrollBarVisibility="Auto" 
                        IsReadOnly="True" FontFamily="Consolas"/>
            </GroupBox>
        </Grid>

        <!-- Status Bar -->
        <StatusBar Grid.Row="4">
            <StatusBarItem>
                <TextBlock Name="txtStatus" Text="Ready"/>
            </StatusBarItem>
            <Separator/>
            <StatusBarItem>
                <ProgressBar Name="progressBar" Width="200" Height="15" Visibility="Collapsed"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>
