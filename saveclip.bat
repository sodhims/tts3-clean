@echo off
powershell -NoProfile -ExecutionPolicy Bypass -Command "Add-Type -AssemblyName Microsoft.VisualBasic; $fn = [Microsoft.VisualBasic.Interaction]::InputBox('Enter filename (full path or name)','Save Clipboard','clip.txt'); if ([string]::IsNullOrWhiteSpace($fn)) { Write-Host 'Cancelled.'; exit 1 }; if (-not [IO.Path]::GetExtension($fn)) { $fn += '.txt' }; if (-not [IO.Path]::IsPathRooted($fn)) { $fn = Join-Path (Get-Location) $fn }; if (Test-Path $fn) { $res = [Microsoft.VisualBasic.Interaction]::MsgBox('File already exists. Choose Yes to overwrite, No to append, Cancel to abort.','YesNoCancel,Question','File Exists'); if ($res -eq 'Yes') { Get-Clipboard -Raw | Set-Content -Encoding UTF8 -NoNewline -LiteralPath $fn; Write-Host 'File overwritten.'; exit 0 } elseif ($res -eq 'No') { Get-Clipboard -Raw | Add-Content -Encoding UTF8 -NoNewline -LiteralPath $fn; Write-Host 'Clipboard appended.'; exit 0 } else { Write-Host 'Cancelled.'; exit 2 } } else { Get-Clipboard -Raw | Set-Content -Encoding UTF8 -NoNewline -LiteralPath $fn; Write-Host 'New file created and clipboard saved.' }"
